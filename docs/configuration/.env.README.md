# Environment Variables Quick Reference

## File Locations (All in Project Root)

```
hiking-portal/
├── .env.local              ← Your local development settings
├── .env.production         ← Your production settings
├── .env.local.example      ← Template for local (check this for reference)
└── .env.production.example ← Template for production (check this for reference)
```

## Quick Start

### Local Development
```bash
# 1. Copy template
cp .env.local.example .env.local

# 2. Start everything
docker-compose up -d
cd backend && npm start
cd frontend && npm start
```

### Production Deployment
```bash
# 1. Copy template
cp .env.production.example .env.production

# 2. Edit with your production values
nano .env.production

# 3. Deploy
./scripts/deploy-backend.sh
./scripts/deploy-frontend.sh
```

## Key Variables

### Backend Variables
```env
NODE_ENV=development|production
PORT=5000|8080
DATABASE_URL=postgresql://user:pass@host:5432/db
JWT_SECRET=<minimum-64-characters>
FRONTEND_URL=http://localhost:3000|https://domain.com
```

### Frontend Variables (Must start with REACT_APP_)
```env
REACT_APP_API_URL=http://localhost:5000|https://backend.run.app
REACT_APP_ENV=development|production
```

### Docker Variables
```env
HIKING_POSTGRES_DB=hiking_portal
HIKING_POSTGRES_USER=postgres
HIKING_POSTGRES_PASSWORD=hiking_password
```

## Common Commands

### Check Environment
```bash
# View your local config
cat .env.local

# View what variables are set
docker-compose config

# Test backend connection
curl http://localhost:5000/health
```

### Reset Local Environment
```bash
# Stop and remove everything
docker-compose down -v

# Start fresh
docker-compose up -d
```

## Where Variables Are Read From

| Component | Reads From | Notes |
|-----------|------------|-------|
| Backend | Root `.env.local` | Explicitly loaded in server.js |
| Frontend | Root `.env.local` | Auto-loaded by react-scripts |
| Docker | Root `.env.local` | Auto-loaded by docker-compose |
| Backend Deploy | Secret Manager | Set via gcloud/Cloud Run console |
| Frontend Deploy | Root `.env.production` | Read during build |

## Important Notes

1. **All `.env` files MUST be in the project root** (not in backend/ or frontend/)
2. **Never commit `.env.local` or `.env.production`** to git
3. **Frontend variables MUST start with `REACT_APP_`**
4. **Restart services** after changing `.env` files
5. **For production**, backend uses Secret Manager, frontend uses `.env.production`

## Troubleshooting

| Problem | Solution |
|---------|----------|
| Backend can't find variables | Check `.env.local` exists in root |
| Frontend variables undefined | Prefix with `REACT_APP_` and restart |
| Docker wrong database | Check `HIKING_POSTGRES_*` in `.env.local` |
| Deploy script error | Check `.env.production` exists in root |

## More Information

- **Full Documentation:** [ENVIRONMENT_SETUP.md](ENVIRONMENT_SETUP.md)
- **Consolidation Details:** [ENV_CONSOLIDATION_SUMMARY.md](ENV_CONSOLIDATION_SUMMARY.md)
- **Production Config:** [PRODUCTION_CONFIG.md](PRODUCTION_CONFIG.md)

## Example .env.local (Minimum)

```env
# Database
DATABASE_URL=postgresql://postgres:hiking_password@hiking_postgres:5432/hiking_portal

# Backend
NODE_ENV=development
PORT=5000
JWT_SECRET=dev-jwt-secret-change-in-production-minimum-64-chars-required
FRONTEND_URL=http://localhost:3000

# Frontend
REACT_APP_API_URL=http://localhost:5000
REACT_APP_ENV=development
```

## Example .env.production (Minimum)

```env
# Database
DATABASE_URL=postgresql://user:pass@34.31.176.242:5432/hiking_portal

# Backend
NODE_ENV=production
PORT=8080
JWT_SECRET=<your-long-secure-secret-minimum-64-characters>
FRONTEND_URL=https://helloliam.web.app

# Frontend
REACT_APP_API_URL=https://backend-554106646136.europe-west1.run.app
REACT_APP_ENV=production

# Email
SENDGRID_API_KEY=SG.your-key
FROM_EMAIL=noreply@thenarrowtrail.org
```

---

**Need help?** Check [ENVIRONMENT_SETUP.md](ENVIRONMENT_SETUP.md) for detailed information.
